{% extends 'base.html.twig' %}
{% block back %}

{% endblock %}
{% block main %}
  {% block titleSection %}

  {% endblock %}

  <div class="row p-3 my-2 my-md-5 w-100 mx-0">
    <button id="filter-toggler" class="w-auto border-0 btn bg-none d-xl-none text-primary">Masquer les filtres</button>
    <div class="col-12 col-lg-4 px-3 px-md-5">
      <section class="bg-white rounded-1 px-4 py-2 py-md-5 my-2 my-md-5 d-lg-block d-none">
        {% include '/_partials/_profile_menu.html.twig' %}
      </section>
      <section id="filter" class="bg-white rounded-1 px-4 py-2 py-md-5 my-2 my-md-5 d-lg-block">
        <h2 class="text-center mb-3 fs-4">Filtrer les sorties</h2>

        {{ form_start(filter_form) }}
        {{ form_row(filter_form.mind) }}
        {{ form_row(filter_form.department) }}
        {{ form_row(filter_form.date) }}
        <div class="range my-5">
          <p class="my-1">Distance (kms)</p>
          {{ form_row(filter_form.distance_min) }}
          {{ form_row(filter_form.distance_max) }}
        </div>
        <div class="range my-5">
          <p class="my-1">Nombre de participants</p>
          {{ form_row(filter_form.participants_min) }}
          {{ form_row(filter_form.participants_max) }}
        </div>
        <div class="range my-5">
          <p class="my-1">Dénivelé positif (m)</p>
          {{ form_row(filter_form.ascent_min) }}
          {{ form_row(filter_form.ascent_max) }}
        </div>
        <div class="range my-5">
          <p class="my-1">Vitesse moyenne (km/h)</p>
          {{ form_row(filter_form.average_speed_min) }}
          {{ form_row(filter_form.average_speed_max) }}
        </div>
        {{ form_row(filter_form.submit) }}
        <a class="px-2 py-2" href="{{ path('app_rides') }}">Réinitialiser les filtres</a>
        {{ form_end(filter_form) }}
      </section>
    </div>

    <div class="col-12 col-lg-8 px-3 px-md-5">
      <section class="rounded-1 my-5">
        <h2 class="text-center mb-3 fs-3">Mes prochaines sorties</h2>
        {# {% if all_my_rides|length is same as %} #}
        {% if (my_next_rides|length) == 0 %}
          <p>Vous n'avez pas de sortie prévue pour le moment.</p>
        {% else %}
          {% for ride in my_next_rides %}
            {% if (ride.date|date('Y-m-d')) > ('now'|date('Y-m-d')) %}
              {% include '/_partials/_ride_card.html.twig' %}
            {% endif %}
          {% endfor %}
        {% endif %}
      </section>
      <section class="rounded-1 my-5">
        <h2 class="text-center mb-3 fs-3">Les sorties à venir</h2>
        {% if (all_rides|length) == 0 %}
<p>Aucune sortie n'a été trouvée. Veuillez élargir vos critères.</p>
        {% endif %}

        {% for ride in all_rides %}
          {% if app.user not in ride.participants %}
            {% include '/_partials/_ride_card.html.twig' %}
          {% endif %}
        {% endfor %}
      </section>
      <div class="container">{{ knp_pagination_render(all_rides, '/_partials/_pagination.html.twig') }}</div>
    </div>
  </div>
{% endblock %}
