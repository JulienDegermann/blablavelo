{% extends 'base.html.twig' %}

{% block mainTitle %}
  Détail de la sortie
{% endblock %}

{% block main %}
  <section class="my-3 my-md-5">
    <div class="container">
      <div class="row position-relative">
        <div class="col-12 col-md-6">
          {% include '/_partials/_practice_img.html.twig' %}
        </div>
        <div class="col-12 col-md-6 position-relative">
          <h2 class="">{{ ride.getTitle }}</h2>
            <div class="my-0">
              <div class="profile participant d-flex flex-row-reverse">
                {% for user in ride.getParticipants %}
                  {% if user.profileImage is not null %}
                    <img class="rounded-circle border border-1 border-primary" src="{{ asset('uploads/images/users/' ~ user.profileImage.getFileName) }}" alt="photo de profil de {{ user.getNameNumber }}" title="{{ user.getNameNumber }}" />
                  {% else %}
                    <div class="account rounded-circle border border-1 border-primary d-flex justify-content-center align-item-center" title="{{ user.getNameNumber }}">
                      {% include '_partials/_avatar.html.twig' %}
                    </div>
                  {% endif %}
                {% endfor %}
            </div>

            <p class="fst-italic text-primary">Guide : {{ ride.getAuthor }}</p>

          </div>
          <h3 class="fs-6">Informations générales</h3>
          <p>
            🚴 : {{ ride.getPractice }} <br />
            🎯 : {{ ride.getMind }} <br />
            🏁 : {{ ride.getDistance }} kms <br />
            📈 : {{ ride.getAscent }} m <br />
            🏎️ : {{ ride.getAverageSpeed }} km/h <br />
            📍 : {{ ride.getCity|capitalize }} <br />
            📆 : {{ ride.getDate|date('D d F Y') }}, {{ ride.getDate|date('H:i') }} <br />
            🕗 : {{ ride.getDate|date('H:i') }} <br />
            👤 : {{ ride.getParticipants|length }} / {{ ride.getMaxRider }}
          </p>

          <h3 class="fs-6">Détails</h3>
          <p>{{ ride.getDescription }}</p>

          {% if user != ride.getAuthor %}
            {% if user in ride.getParticipants %}
              <a href="{{ path('app_ride_remove', { id: ride.getId() }) }}" class="btn btn-secondary text-primary px-5 py-2">Ne plus participer</a>
            {% else %}
              {% if ride.getMaxRider > (ride.getParticipants|length) %}
                <a href="{{ path('app_ride_connect', { id: ride.getId() }) }}" class="btn btn-primary text-white px-5 py-2">J'EN SUIS !</a>
              {% endif %}
            {% endif %}
          {% else %}
            <a href="{{ path('app_ride_delete', { id: ride.getId() }) }}" class="btn btn-secondary text-primary px-5 py-2">Supprimer la sortie</a>
          {% endif %}
        </div>
      </div>
    </div>
  </section>

  <section class="my-5">
    <div class="container">
      <h3>Commentaires</h3>
      <div class="d-flex flex-column-reverse">
        {% for comment in ride.getRideComments%}
        <p><span class="fw-bold">{% if comment.getAuthor is same as user %} Moi {% else %} {{ comment.getAuthor.getNameNumber }} {% endif %}</span> : {{ comment.getText }} </p>
        {% endfor %}
      </div>
      {{ form_start(form) }}
      {{ form_end(form) }}
    </div>
  </section>
{% endblock %}
